<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<TargetFrameworks>net10.0-ios</TargetFrameworks>

		<OutputType>Exe</OutputType>
		<RootNamespace>MauiAppIntentsSample</RootNamespace>
		<UseMaui>true</UseMaui>
		<SingleProject>true</SingleProject>
		<ImplicitUsings>enable</ImplicitUsings>
		<Nullable>enable</Nullable>

		<!-- Enable XAML source generation for faster build times and improved performance.
		     This generates C# code from XAML at compile time instead of runtime inflation.
		     To disable, remove this line.
		     For individual files, you can override by setting Inflator metadata:
		       <MauiXaml Update="MyPage.xaml" Inflator="Default" /> (reverts to defaults: Runtime for Debug, XamlC for Release)
		       <MauiXaml Update="MyPage.xaml" Inflator="Runtime" /> (force runtime inflation) -->
		<MauiXamlInflator>SourceGen</MauiXamlInflator>

		<!-- Display name -->
		<ApplicationTitle>TaskTracker</ApplicationTitle>

		<!-- App Identifier -->
		<ApplicationId>com.companyname.mauiappintentssample</ApplicationId>

		<!-- Versions -->
		<ApplicationDisplayVersion>1.0</ApplicationDisplayVersion>
		<ApplicationVersion>1</ApplicationVersion>

		<!-- To develop, package, and publish an app to the Microsoft Store, see: https://aka.ms/MauiTemplateUnpackaged -->
		<WindowsPackageType>None</WindowsPackageType>

		<SupportedOSPlatformVersion Condition="$([MSBuild]::GetTargetPlatformIdentifier('$(TargetFramework)')) == 'ios'">17.0</SupportedOSPlatformVersion>
	</PropertyGroup>

	<ItemGroup>
		<!-- App Icon -->
		<MauiIcon Include="Resources\AppIcon\appicon.svg" ForegroundFile="Resources\AppIcon\appiconfg.svg" Color="#512BD4" />

		<!-- Splash Screen -->
		<MauiSplashScreen Include="Resources\Splash\splash.svg" Color="#512BD4" BaseSize="128,128" />

		<!-- Images -->
		<MauiImage Include="Resources\Images\*" />
		<MauiImage Update="Resources\Images\dotnet_bot.png" Resize="True" BaseSize="300,185" />
		
		<!-- Custom Fonts -->
		<MauiFont Include="Resources\Fonts\*" />

		<!-- Raw Assets (also remove the "Resources\Raw" prefix) -->
		<MauiAsset Include="Resources\Raw\**" LogicalName="%(RecursiveDir)%(Filename)%(Extension)" />
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="Microsoft.Maui.Controls" Version="$(MauiVersion)" />
		<PackageReference Include="Microsoft.Extensions.Logging.Debug" Version="10.0.0" />
		<PackageReference Include="CommunityToolkit.Mvvm" Version="8.4.0" />
	</ItemGroup>

	<!-- Reference the Swift App Intents binding library -->
	<ItemGroup>
		<ProjectReference Include="..\MauiAppIntentsSample.Binding\MauiAppIntentsSample.Binding.csproj" />
	</ItemGroup>

	<!-- Copy App Intents Metadata into the app bundle so iOS discovers the intents.
	     The metadata is extracted by the binding project's ExtractAppIntentsMetadata target
	     from the xcarchive output into its intermediate directory. -->
	<Target Name="CopyAppIntentsMetadata" AfterTargets="_CopyResourcesToBundle">
		<PropertyGroup>
			<_BindingMetadataDir>..\MauiAppIntentsSample.Binding\obj\$(Configuration)\$(TargetFramework)\xcode\Metadata.appintents</_BindingMetadataDir>
		</PropertyGroup>
		<ItemGroup>
			<_AppIntentsMetadata Include="$(_BindingMetadataDir)\**\*" Condition="Exists('$(_BindingMetadataDir)')" />
		</ItemGroup>
		<Copy SourceFiles="@(_AppIntentsMetadata)"
			  DestinationFolder="$(AppBundleDir)/Metadata.appintents/%(RecursiveDir)"
			  Condition="'@(_AppIntentsMetadata)' != ''" />
		<Message Text="Copied App Intents Metadata to $(AppBundleDir)/Metadata.appintents" Importance="high"
			  Condition="'@(_AppIntentsMetadata)' != ''" />
	</Target>

</Project>
